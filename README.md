# 麦克风批量测试工具 - Web版本 v2.10

基于 Flask 和 Web Audio API 的网页版麦克风测试工具。

## 🚀 快速开始

### 1. 安装依赖

```bash
# 方式1: 使用批处理文件（Windows）
双击运行: 安装依赖.bat

# 方式2: 使用命令行
pip install -r requirements.txt
```

### 2. 启动服务器

```bash
# 方式1: 使用批处理文件（Windows）
双击运行: 启动服务器.bat

# 方式2: 使用命令行
python app.py
```

### 3. 访问网页

服务器启动后，在浏览器中打开：
```
http://127.0.0.1:5000
```

## 📋 功能特性

- ✅ **Web Audio API 录音** - 使用浏览器原生API进行高质量录音
- ✅ **实时波形显示** - 使用 Chart.js 显示实时音频波形
- ✅ **音频质量分析** - RMS、SNR、THD、Peak、MAV、峰值因数等指标
- ✅ **标准麦克风参考** - 设置标准麦克风作为参考基准
- ✅ **可配置检测项** - 灵活配置各种检测开关
- ✅ **测试结果统计** - 实时显示合格率统计
- ✅ **Excel报告导出** - 一键导出详细测试报告
- ✅ **响应式设计** - 适配不同屏幕尺寸

## 🎯 使用说明

### 基本测试流程

1. **选择设备**: 在"设备选择"下拉框中选择要测试的麦克风
2. **设置编号**: 设置当前测试的麦克风编号
3. **开始测试**: 点击"🎤 开始测试"按钮，程序会自动录音并分析
4. **查看结果**: 测试完成后，在"测试结果"区域查看详细数据

### 标准麦克风功能

1. 点击"📌 设置标准麦克风模式"按钮
2. 进行测试，该测试结果将自动设为标准麦克风
3. 后续测试将与该标准麦克风进行对比

### 检测设置

- **主要检测（必须）**: RMS范围检测
- **可选检测**: 可勾选/取消各种检测项
  - THD失真度检测
  - Peak削波检测
  - SNR信噪比检测
  - RMS偏差检测（标准麦克风）
  - 声卡回放通道检测
  - MAV平均绝对值检测
  - 峰值因数检测

## ⚙️ 配置说明

配置文件: `config.json`

主要配置项：
- `sample_rate`: 采样率（默认44100）
- `duration`: 录音时长（秒，默认3）
- `test_frequency`: 测试频率（Hz，默认1000）
- `min_rms`: 最小RMS阈值
- `max_rms`: 最大RMS阈值
- `sensitivity_tolerance`: 灵敏度容差（默认0.3，即30%）

## 📊 测试指标说明

- **RMS**: 均方根值，表示平均音量大小
- **Peak**: 峰值，表示最大振幅
- **SNR**: 信噪比，信号与噪声的比值（dB）
- **THD**: 总谐波失真，表示信号失真程度（%）
- **MAV**: 平均绝对值，音频信号的平均绝对值
- **峰值因数**: Peak/RMS，表示动态范围
- **RMS偏差**: 相对于标准麦克风的RMS偏差百分比

## 🌐 浏览器兼容性

- ✅ Chrome/Edge (推荐)
- ✅ Firefox
- ✅ Safari
- ⚠️ 需要支持 Web Audio API

## 📝 注意事项

1. **麦克风权限**: 首次使用时，浏览器会请求麦克风权限，请点击"允许"
2. **HTTPS要求**: 某些浏览器可能要求HTTPS才能访问麦克风（本地localhost除外）
3. **设备选择**: 如果设备列表为空，请点击"🔄 刷新设备"
4. **测试音播放**: 建议使用外部播放器播放测试音文件，避免内部回环

## 🔧 故障排查

### 无法录音
- 检查浏览器是否已授予麦克风权限
- 确认麦克风设备已正确连接
- 尝试刷新设备列表

### 波形不显示
- 检查浏览器控制台是否有错误
- 确认 Chart.js 库已正确加载

### 分析失败
- 检查后端服务器是否正常运行
- 查看浏览器控制台的错误信息

## 📄 许可证

本项目仅供内部使用。

## 🔄 版本历史

### v2.10 (Web版)
- 初始Web版本发布
- 基于Flask后端和Web Audio API前端
- 完整实现所有v2.10功能

