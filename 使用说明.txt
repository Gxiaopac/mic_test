━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  麦克风测试工具 - Web版本使用说明
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🚀 快速开始
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 安装依赖
   双击运行: 安装依赖.bat
   或使用命令行: pip install -r requirements.txt

2. 启动服务器
   双击运行: 启动服务器.bat
   或使用命令行: python app.py

3. 打开浏览器
   访问: http://127.0.0.1:5000

4. 授予麦克风权限
   首次使用时，浏览器会请求麦克风权限，请点击"允许"


📋 界面功能说明
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【左侧控制面板】

  ▸ 设备选择
    - 下拉框显示所有可用的麦克风设备
    - 点击"🔄 刷新设备"重新加载设备列表

  ▸ 测试设置
    - 麦克风编号: 设置当前测试的麦克风编号
    - 🎤 开始测试: 开始录音并分析
    - 🔊 播放录音: 回听最后录制的音频

  ▸ 标准麦克风
    - 📌 设置标准麦克风模式: 激活后，下次测试将设为标准麦克风
    - 标准麦克风信息: 显示当前标准麦克风的详细参数

  ▸ 检测设置
    - 主要检测（必须）: RMS范围检测
    - 可选检测: 可勾选/取消各种检测项

  ▸ 测试统计
    - 实时显示总数、合格数、不合格数、合格率

  ▸ 操作按钮
    - 📊 导出报告: 生成Excel测试报告
    - 🗑️ 清空结果: 清除所有测试记录


【右侧内容区】

  ▸ 实时波形
    - 显示录音过程中的实时波形
    - 测试完成后显示完整波形

  ▸ 测试结果
    - 显示详细的测试数据和判定结果
    - 状态标识: ✅ 合格 / ❌ 不合格 / 📌 标准麦克风

  ▸ 测试日志
    - 记录所有测试操作和结果
    - 彩色标识: 绿色(合格)、红色(不合格)、蓝色(标准麦克风)


🎯 测试流程
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 选择麦克风设备
   - 在"设备选择"下拉框中选择要测试的麦克风

2. 设置麦克风编号
   - 输入或使用 +/- 按钮调整编号

3. 开始测试
   - 点击"🎤 开始测试"按钮
   - 程序会自动录音（默认3秒）
   - 录音完成后自动分析

4. 查看结果
   - 在"测试结果"区域查看详细数据
   - 在"测试日志"中查看测试记录

5. 继续测试
   - 麦克风编号会自动+1
   - 重复步骤3-4进行批量测试


📌 标准麦克风功能
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 设置标准麦克风
   - 点击"📌 设置标准麦克风模式"按钮（按钮变绿表示已激活）
   - 进行测试，该测试结果将自动设为标准麦克风
   - 按钮会自动恢复，标准麦克风信息会显示在界面上

2. 使用标准麦克风
   - 设置标准麦克风后，后续测试会与该标准进行对比
   - RMS偏差检测会检查测试麦克风与标准麦克风的差异
   - 只检测RMS偏小的情况，偏大说明灵敏度好，不算不合格

3. 调整灵敏度容差
   - 在 config.json 中修改 sensitivity_tolerance 参数
   - 默认值为 0.3（即30%）


⚙️ 检测设置说明
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【主要检测（必须）】
  • RMS范围检测: 检查音量是否在合理范围内

【可选检测】
  ✓ THD失真度检测: 检测信号失真程度
  ✓ Peak削波检测: 检测信号是否削波
  ✓ SNR信噪比检测: 检测信噪比是否足够
  ✓ RMS偏差检测: 与标准麦克风对比RMS偏差
  ✓ 声卡回放通道检测: 检测是否为内部回环
  ✓ MAV平均绝对值检测: 检测平均绝对值范围
  ✓ 峰值因数检测: 检测峰值因数范围

可通过界面上的复选框开启/关闭各项检测


📊 测试指标说明
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

• RMS (均方根值): 表示平均音量大小
• Peak (峰值): 表示最大振幅
• SNR (信噪比): 信号与噪声的比值，单位dB
• THD (总谐波失真): 信号失真程度，单位%
• MAV (平均绝对值): 音频信号的平均绝对值
• 峰值因数: Peak/RMS，表示动态范围
• RMS偏差: 相对于标准麦克风的RMS偏差百分比


💡 使用技巧
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 首次使用
   - 建议先测试一个已知良好的麦克风作为标准麦克风

2. 批量测试
   - 测试完成后，编号会自动+1，方便连续测试
   - 可以随时查看统计信息了解测试进度

3. 结果分析
   - 查看"问题诊断"了解具体不合格原因
   - 即使合格，也可以查看RMS偏差值进行进一步评估

4. 报告导出
   - 测试完成后，点击"📊 导出报告"生成Excel文件
   - 报告包含所有测试数据和统计信息


⚠️ 注意事项
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 麦克风权限
   - 浏览器首次使用会请求麦克风权限，必须点击"允许"
   - 如果权限被拒绝，需要到浏览器设置中手动允许

2. 设备选择
   - 如果设备列表为空，点击"🔄 刷新设备"
   - 确保麦克风已正确连接到电脑

3. 测试环境
   - 建议在安静的环境中进行测试
   - 使用外部播放器播放测试音，避免内部回环

4. 浏览器兼容性
   - 推荐使用 Chrome 或 Edge 浏览器
   - 需要支持 Web Audio API


🔧 故障排查
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

问题: 无法录音
解决: 
  - 检查浏览器是否已授予麦克风权限
  - 确认麦克风设备已正确连接
  - 尝试刷新设备列表

问题: 波形不显示
解决:
  - 检查浏览器控制台是否有错误
  - 确认网络连接正常（需要加载Chart.js库）

问题: 分析失败
解决:
  - 检查后端服务器是否正常运行
  - 查看浏览器控制台的错误信息
  - 确认已正确安装所有依赖包

问题: 无法导出报告
解决:
  - 确认有测试结果
  - 检查 test_results 目录是否有写入权限


📞 技术支持
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

如遇到问题，请检查：
1. Python版本（建议3.8+）
2. 依赖包是否正确安装
3. 浏览器控制台错误信息
4. 服务器终端错误信息

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

